<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="Machine Learning per la previsione di guasti dei dispositivi IoT">
    <meta name="keywords" content="IoT Guardian - Beyond Limits AI Company">
    <meta name="author" content="Luca Zenere">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT Guardian - Beyond Limits AI Company</title>
    <link rel="icon" type="image/x-icon" href="../static/images/favicon.ico">
    <link rel="stylesheet" href="../static/css/style.css">
</head>
<body>
    <div class="header">
        <div class="logo"><img src="../static/images/logo.png" alt="Logo IoT Guardian - Beyond Limits AI Company"></div>
        <div>
            <h1>IoT Guardian - Beyond Limits AI Company</h1>
            <h4>Sistema di Manutenzione Predittiva IoT Industriale</h4>
        </div>
    </div>

    <div class="container">
        <div class="input-panel">
            <h2 class="panel-title">Inserimento Parametri Dispositivo</h2>
            
            <form id="predictionForm">
                <!-- Tipo di Dispositivo - Campo unico a tutta larghezza -->
                <div class="form-group full-width">
                    <label for="machineType">Tipo di Dispositivo:</label>
                    <select id="machineType" name="machineType" required>
                        <option value="">Seleziona dispositivo...</option>
                        <optgroup label="Dispositivi Base">
                            <option value="3D_Printer">Stampante 3D</option>
                            <option value="AGV">Veicolo Guidato Automaticamente</option>
                            <option value="Automated_Screwdriver">Avvitatore Automatico</option>
                            <option value="CMM">Macchina di Misura Coordinata</option>
                            <option value="Carton_Former">Formatrice Cartoni</option>
                            <option value="Compressor">Compressore</option>
                            <option value="Conveyor_Belt">Nastro Trasportatore</option>
                            <option value="Crane">Gru</option>
                            <option value="Dryer">Essiccatore</option>
                            <option value="Forklift_Electric">Carrello Elevatore Elettrico</option>
                            <option value="Grinder">Smerigliatrice</option>
                            <option value="Labeler">Etichettatrice</option>
                            <option value="Mixer">Miscelatore</option>
                            <option value="Palletizer">Palletizzatore</option>
                            <option value="Pick_and_Place">Sistema Pick and Place</option>
                            <option value="Press_Brake">Pressa Piegatrice</option>
                            <option value="Pump">Pompa</option>
                            <option value="Robot_Arm">Braccio Robotico</option>
                            <option value="Shrink_Wrapper">Termoconfezionatrice</option>
                            <option value="Shuttle_System">Sistema Shuttle</option>
                            <option value="Vacuum_Packer">Confezionatrice Sottovuoto</option>
                            <option value="Valve_Controller">Controller Valvole</option>
                            <option value="Vision_System">Sistema di Visione</option>
                            <option value="XRay_Inspector">Ispettore a Raggi X</option>
                        </optgroup>
                        <optgroup label="Dispositivi con Caratteristiche Speciali">
                            <option value="Laser_Cutter">Tagliatrice Laser</option>
                            <option value="Hydraulic_Press">Pressa Idraulica</option>
                            <option value="Injection_Molder">Stampaggio a Iniezione</option>
                            <option value="CNC_Lathe">Tornio CNC</option>
                            <option value="CNC_Mill">Fresatrice CNC</option>
                            <option value="Industrial_Chiller">Refrigeratore Industriale</option>
                            <option value="Boiler">Caldaia</option>
                            <option value="Furnace">Forno</option>
                            <option value="Heat_Exchanger">Scambiatore di Calore</option>
                        </optgroup>
                    </select>
                    <div class="machine-info" id="machineInfo" style="display: none;"></div>
                </div>

                <!-- Campi in due colonne -->
                <div class="form-columns">
                    <div class="form-column">
                        <div class="form-group">
                            <label for="installationYear">Anno di Installazione:</label>
                            <input type="number" id="installationYear" name="installationYear" min="2000" max="2025" required>
                        </div>

                        <div class="form-group">
                            <label for="operationalHours">Ore Operative:</label>
                            <input type="number" id="operationalHours" name="operationalHours" min="0" step="0.1" required>
                        </div>

                        <div class="form-group">
                            <label for="temperature">Temperatura (°C):</label>
                            <input type="number" id="temperature" name="temperature" step="0.1" required>
                        </div>

                        <div class="form-group">
                            <label for="vibration">Vibrazione (mm/s):</label>
                            <input type="number" id="vibration" name="vibration" min="0" step="0.01" required>
                        </div>

                        <div class="form-group">
                            <label for="sound">Suono (dB):</label>
                            <input type="number" id="sound" name="sound" min="0" step="0.1" required>
                        </div>

                        <div class="form-group">
                            <label for="oilLevel">Livello Olio (%):</label>
                            <input type="number" id="oilLevel" name="oilLevel" min="0" max="100" step="0.1" required>
                        </div>

                        <div class="form-group">
                            <label for="coolantLevel">Livello Liquido Raffreddamento (%):</label>
                            <input type="number" id="coolantLevel" name="coolantLevel" min="0" max="100" step="0.1" required>
                        </div>

                        <div class="form-group">
                            <label for="powerConsumption">Consumo Energetico (kW):</label>
                            <input type="number" id="powerConsumption" name="powerConsumption" min="0" step="0.1" required>
                        </div>
                    </div>

                    <div class="form-column">
                        <div class="form-group">
                            <label for="lastMaintenance">Giorni dall'Ultima Manutenzione:</label>
                            <input type="number" id="lastMaintenance" name="lastMaintenance" min="0" required>
                        </div>

                        <div class="form-group">
                            <label for="maintenanceCount">Numero di Manutenzioni:</label>
                            <input type="number" id="maintenanceCount" name="maintenanceCount" min="0" required>
                        </div>

                        <div class="form-group">
                            <label for="failureCount">Numero di Guasti:</label>
                            <input type="number" id="failureCount" name="failureCount" min="0" required>
                        </div>

                        <div class="form-group">
                            <label for="errorCodes">Errori negli Ultimi 30 Giorni:</label>
                            <input type="number" id="errorCodes" name="errorCodes" min="0" required>
                        </div>

                        <div class="form-group">
                            <label for="aiSupervision">Supervisione AI:</label>
                            <select id="aiSupervision" name="aiSupervision" required>
                                <option value="">Seleziona...</option>
                                <option value="1">Attiva</option>
                                <option value="0">Non Attiva</option>
                            </select>
                        </div>

                        <!-- Campo Override AI - Visibile solo se Supervisione AI è attiva -->
                        <div class="form-group" id="aiOverridesGroup" style="display: none;">
                            <label for="aiOverrides">Allarmi AI Ignorati:</label>
                            <input type="number" id="aiOverrides" name="aiOverrides" min="0">
                        </div>
                    </div>
                </div>

                <!-- Campi aggiuntivi per dispositivi speciali -->
                <div id="additionalFields" class="additional-fields" style="display: none;">
                    <h4>Caratteristiche Aggiuntive</h4>
                    
                    <div class="form-group" id="laserIntensityGroup" style="display: none;">
                        <label for="laserIntensity">Intensità Laser:</label>
                        <input type="number" id="laserIntensity" name="laserIntensity" min="0" step="0.1">
                    </div>

                    <div class="form-group" id="hydraulicPressureGroup" style="display: none;">
                        <label for="hydraulicPressure">Pressione Idraulica (bar):</label>
                        <input type="number" id="hydraulicPressure" name="hydraulicPressure" min="0" step="0.1">
                    </div>

                    <div class="form-group" id="coolantFlowGroup" style="display: none;">
                        <label for="coolantFlow">Portata Refrigerante (L/min):</label>
                        <input type="number" id="coolantFlow" name="coolantFlow" min="0" step="0.1">
                    </div>

                    <div class="form-group" id="heatIndexGroup" style="display: none;">
                        <label for="heatIndex">Indice di Calore:</label>
                        <input type="number" id="heatIndex" name="heatIndex" min="0" step="0.1">
                    </div>
                </div>

                <button type="submit" class="btn" id="predictBtn">
                    Esegui Previsione
                </button>
            </form>
        </div>

        <div class="results-panel">
            <h2 class="panel-title">Risultati Previsione</h2>
            
            <div id="welcomeMessage">
                <div class="result-card">
                    <h3 class="result-title">🔍 Benvenuto nel Sistema di Manutenzione Predittiva</h3>
                    <p class="prediction-text">
                        Inserisci i parametri del dispositivo IoT nella sezione a sinistra per ottenere una previsione accurata sui rischi di guasto e raccomandazioni per la manutenzione.
                    </p>
                    <p class="prediction-text">
                        Il sistema analizza oltre 20 parametri diversi per fornire previsioni affidabili sulla salute dei tuoi dispositivi industriali.
                    </p>
                    <div style="text-align: center; margin-top: 1.5rem;">
                        <span class="risk-low">Sistema pronto per l'analisi</span>
                    </div>
                </div>
            </div>

            <div id="loadingMessage" class="loading">
                <div class="spinner"></div>
                <p>Elaborazione previsione in corso...</p>
                <p style="font-size: 0.9rem; color: #7f8c8d;">Analisi dei parametri con algoritmi di Machine Learning</p>
            </div>

            <div id="resultsContainer" style="display: none;">
                <div id="predictionResult" class="result-card">
                    <h3 class="result-title">📊 Risultato Previsione</h3>
                    <div id="predictionText" class="prediction-text"></div>
                    <div id="riskLevel" style="text-align: center; margin-top: 1rem;"></div>
                </div>

                <div id="chartContainer" class="chart-container">
                    <canvas id="riskChart" width="400" height="200"></canvas>
                </div>

                <div id="recommendationsCard" class="result-card">
                    <h3 class="result-title">💡 Raccomandazioni</h3>
                    <div id="recommendationsText" class="prediction-text"></div>
                </div>
            </div>

            <div id="errorContainer" style="display: none;">
                <div class="error-message">
                    <strong>⚠️ Errore durante la previsione:</strong>
                    <div id="errorText"></div>
                    <p style="margin-top: 1rem; font-size: 0.9rem;">
                        Verifica i dati inseriti e riprova. Se il problema persiste, contatta l'assistenza tecnica.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="../static/js/main.js"></script>
</body>
</html>